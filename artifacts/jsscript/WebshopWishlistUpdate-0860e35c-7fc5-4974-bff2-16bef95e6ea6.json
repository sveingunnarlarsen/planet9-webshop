{
	"id": "0860e35c-7fc5-4974-bff2-16bef95e6ea6",
	"createdAt": "2018-06-07T09:34:06.000Z",
	"createdBy": "morten",
	"globalScripts": [],
	"externalModules": [],
	"entitySets": [
		{
			"id": "a7b3288c-9dc1-45b5-a7f3-d525daba26e7",
			"selected": true,
			"name": "p9wishlist",
			"contextname": ""
		}
	],
	"apis": [],
	"name": "WebshopWishlistUpdate",
	"ver": "18.8.20.146",
	"description": "Webshop: Update Wishlist",
	"content": [
		"==OBJECT STRING==",
		"try {",
		"",
		"    let favorite = true;",
		"    let productNo = 110004;",
		"    let uname = 'morten';",
		"",
		"    if (req.query) {",
		"        // log.info(\"WebshopGetCategory -> req.query.category: \" + req.query.category);",
		"        productNo = req.query.productNo;",
		"        favorite = req.query.favorite;",
		"    }",
		"    if (req.user) {",
		"        log.info(\"WebshopGetCategory -> req.user.username: \" + req.user.username);",
		"        uname = req.user.username;",
		"    }",
		"    log.info('p9wishlist -> username: ' + uname + ', favorite: ' + favorite);",
		"",
		"    let wishlist = await tables.p9wishlist.find({",
		"        username: uname,",
		"        productNo: productNo",
		"    });",
		"    ",
		"    log.info('p9wishlist -> wishlist: ' + JSON.stringify(wishlist));",
		"    // console.log('p9wishlist -> wishlist: ' + JSON.stringify(wishlist));",
		"    ",
		"    wishlist = wishlist[0];",
		"    log.info('p9wishlist -> wishlist: ' + JSON.stringify(wishlist));",
		"    ",
		"    if(wishlist && !favorite){",
		"        ",
		"        log.info('p9wishlist -> wishlist && !favorite');",
		"    // if (Array.isArray(obj) && obj.length === 1) {",
		"    ",
		"        await tables.p9wishlist.destroy({",
		"            id: wishlist.id",
		"        });",
		"    }",
		"    else if(!wishlist && favorite){",
		"        ",
		"        log.info('p9wishlist -> !wishlist && favorite');",
		"        ",
		"        await tables.p9wishlist.create({",
		"            id: uuid(),",
		"            createdAt: new Date(),",
		"            username: uname,",
		"            productNo: productNo",
		"        });",
		"    }",
		"",
		"    // log.info('p9wishlist -> wishlist: ' + JSON.stringify(wishlist));",
		"    // console.log('p9wishlist -> wishlist: ' + JSON.stringify(wishlist));",
		"",
		"} catch (e) {",
		"    // result = setStatus(99, e);",
		"    log.info('ERROR Updating... -> ' + JSON.stringify(e));",
		"}",
		"",
		"complete();",
		"",
		""
	],
	"useAsGlobalScript": false,
	"isTypescript": false,
	"transpiledContent": null,
	"lastRunSuccessful": false,
	"jsscriptGroup": "b348e8c2-3ad0-4d52-8334-58f371f58d7c",
	"package": "3b6d7a6b-5bd6-40e8-b5d4-70e4be5c46e0"
}